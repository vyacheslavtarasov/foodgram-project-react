# Проект Foodgram

[![Python](https://img.shields.io/badge/Python-%203.9-6495ED?style=flat-square&logo=Python)](https://www.python.org/)
[![Django](https://img.shields.io/badge/Django-%203.2-6495ED?style=flat-square&logo=django)](https://www.djangoproject.com/)
[![Pytest](https://img.shields.io/badge/Pytest-6.2.4-6495ED?style=flat-square&logo=pytest-)](https://docs.pytest.org/en/6.2.x/)


## Описание:
Проект Foodgram хранит и систематизирует рецепты по тегам. 
Позволяет создавать новые рецепты, подписываться на авторов и сохранять список ингредиентов выбранных рецептом как список покупок.


## Функционал

- Проект Foodgram позволяет сохранять рецепты блюд каждому зарегистрированому пользователю;
- Каждому блюду могут быть выставлены теги для удобства пользования;
- Добавлять ингредиенты для составления рецептов и теги может только админитсратор через админ панель.
- Пользователь может подписываться на других пользователей, чтобы смотреть их рецепты;
- Поользователь может скачать список ингредиентов из выбранных рецептов, как список для покупок;
- Пользователь может заносить рецепты в избраное.
- Размер картинки не должен превышать 1Mb.


## Локальный запуск сайта
Установить платформу Docker (c wsl2.0) с сайта в соответствии со своей операционной ситстемой:
```
https://docs.docker.com/desktop/
```
Запустить процесс-сервис платформы Docker:
```
Для Linux - sudo systemctl start docker
Для Windows - запустить приложение Docker из места установки
```
Клонировать репозиторий.
```
git clone git@github.com:vyacheslavtarasov/foodgram-project-react.git
```
Перейти парку infra, склонированного репозитория.    
Создать и заполнить там файл .env по примеру файла .env.example, уже лежащего в папке.   
Запустить разворачивание сайта на локальной платфоре Docker и дождаться завершения.   
```
docker-compose up
```
Сайт будет доступен по адресу http://localhost:9000/   
Админ зона http://localhost:9000/admin/   
По умолчанию будет создан один суперпользователь   
 - Имя - admin
 - Пароль - admin123admin


## Разработка и тестирование API
Разработку и тестирование API удобно осуществлять не в докер контейнере, а локально, использую встроенный сервер Django.   
Для этого надо.   
Клонировать репозиторий.
```
git clone git@github.com:vyacheslavtarasov/foodgram-project-react.git
```
Перейти в папку проекта backend.
Cоздать виртуальное окружение.
```
python3 -m venv env
```
Установить зависимости из файла requirements.txt:
```
python3 -m pip install --upgrade pip
```
```
pip install -r requirements.txt
```
Перейти в папку проекта foodgram.  
В настройках django проекта (foodgram.settings.py) изменить базу на локальную db.sqlite3. (раскомментить секцию DATABASES)
Выполнить миграции:
```
python3 manage.py migrate
```
Загрузить начальные данные в базу.
```
python manage.py dbdataimport
```
Запустить проект.
```
python manage.py runserver
```
API будет доступа по адресу http://localhost:9000/  


## Поддержка развёрнутого в интеренете проекта.
Сайт и API развёрнуты и доступен в интернете по адресу https://practicum16aihal21.ddns.net/
Для осуществления поддержки развёрнутого со своей машины необходимо:  
Склонировать репозиторий на свой аккаунт GitHub  
```
https://github.com/vyacheslavtarasov/foodgram-project-react
```
Заполнить секретные переменные (foodgram-project-react/settings/secrets/actions) на сайте github в своём склонированном репозитории.
Параметры докер репозитория:  
``` 
- secrets.DOCKER_USERNAME
- secrets.DOCKER_PASSWORD
Параметры доступа к серверу:  
- secrets.HOST
- secrets.USER
- secrets.SSH_KEY
- secrets.SSH_PASSPHRASE
```
Клонировать репозиторий.foodgram-project-react/settings/secrets/actions
```
git clone git@github.com:vyacheslavtarasov/foodgram-project-react.git
```
Внести необходимые правки, проверить их локально любым удобным способом.   
Залить обратно в репозиторий git.


**В проекте доступны следующие эндпоинты:**
```
http://127.0.0.1:8000/api/v1/auth/signup/ 
```
POST-запрос — получение кода подтверждения (confirmation_code) на указанный email.
```
http://127.0.0.1:8000/api/v1/auth/token/ 
```
POST-запрос — получение Access-токена в обмен на username и confirmation_code.
```
http://127.0.0.1:8000/api/v1/users/  
```
GET-запрос — получение списка всех пользователей   
POST-запрос — добавление нового пользователя.  
Доступно для пользователей с ролью "администратор".
```
http://127.0.0.1:8000/api/v1/users/{username}/ 
```
GET-запрос — получение пользователя по username.  
PATCH-запрос — редактирование данных пользователя.  
DELETE-запрос — удаление пользователя.  
Доступно для пользователей с ролью "администратор". 
```
http://127.0.0.1:8000/api/v1/users/me/ 
```
GET-запрос — получение данных о своей учётной записи.  
PATCH-запрос — редактирование своей учётной записи.   
Изменить роль пользователя нельзя.  
Права доступа — любой зарегистрированный пользователь. 
```
http://127.0.0.1:8000/api/v1/categories/ 
```
GET-запрос — получение списка всех категорий (доступно без токена).   
POST-запрос — создание новой категории (доступно для администратора).
```
http://127.0.0.1:8000/api/v1/categories/{slug}/ 
```
DELETE-запрос — удаление категории по её slug.  
Доступно для пользователей с ролью "администратор". 
```
http://127.0.0.1:8000/api/v1/genres/
```
GET-запрос — получение списка всех жанров (доступно без токена).   
POST-запрос — добавление нового жанра (доступно для администратора).
```
http://127.0.0.1:8000/api/v1/genres/{slug}/
```
DELETE-запрос — удаление жанра по его slug.
Доступно для пользователей с ролью "администратор".   
```
http://127.0.0.1:8000/api/v1/titles/
```
GET-запрос — получение списка всех произведений (доступно без токена).   
POST-запрос — добавление нового произведения (доступно для администратора).
```
http://127.0.0.1:8000/api/v1/titles/{titles_id}/
```
GET-запрос — получение информации о произведении (доступно без токена).   
PATCH-запрос — обновление информации о произведении (доступно для администратора).   
DELETE-запрос — удаление произведения (доступно для администратора).
```
http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/
```
GET-запрос — получение списка всех отзывов (доступно без токена).   
POST-запрос — добавление нового отзыва (доступно для аутентифицированных пользователей).   
Пользователь может оставить один отзыв на произведение.
```
http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/
```
GET-запрос — получение отзыва о произведении по его id (доступно без токена).   
PATCH-запрос — изменение отзыва (доступно для администратора, модератора и автора отзыва).   
DELETE-запрос — удаление отзыва по id (доступно для модератора, администратора и автора отзыва).
```
http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/
```
GET-запрос — получение списка комментариев к отзыву (доступно без токена).   
POST-запрос — добавление комментария к отзыву (доступно для аутентифицированных пользователей).
```
http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/
```
GET-запрос — получение информации, о комментарии по id (доступно без токена).   
PATCH-запрос — частичное обновление комментария (доступно для администратора, модератора и автора комментария).   
DELETE-запрос — удаление комментария (доступно для администратора, модератора и автора комментария).

## Авторы проекта:
- [Vyacheslav Tarasov](https://github.com/vyacheslavtarasov)
